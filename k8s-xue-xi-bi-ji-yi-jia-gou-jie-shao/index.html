<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    K8s学习笔记（一）架构介绍 | 半亩房顶
</title>
<link rel="shortcut icon" href="https://freephenix.github.io//favicon.ico?v=1713840769430">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://freephenix.github.io//styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://freephenix.github.io//media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-147240912-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-147240912-1');
    </script>
    
        
            
                <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
                <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
                

                    
                            
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://freephenix.github.io/">
                <img class="avatar" src="https://freephenix.github.io//images/avatar.png?v=1713840769430" alt="">
            </a>
            <div class="site-title">
                <h1>
                    半亩房顶
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="https://freephenix.github.io//post/guan-yu-ban-mu-fang-ding/" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            K8s学习笔记（一）架构介绍
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2020-10-16</time>
                            
                                <a href="https://freephenix.github.io/hyhBukwEv/" class="post-tag i-tag
                            i-tag-other_4">
                            #K8S
                        </a>
                                
                                <a href="https://freephenix.github.io/Np4X_h_ZhX/" class="post-tag i-tag
                            i-tag-primary">
                            #Docker
                        </a>
                                
                        </div>
                        
                            <div class="post-feature-image" style="background-image: url('https://freephenix.github.io//post-images/k8s-xue-xi-bi-ji-yi-jia-gou-jie-shao.png')"></div>
                            
                                <div class="post-content">
                                    <p>Kubernetes =&gt; k(8个字符)s</p>
<!-- more -->
<h1 id="k8s是什么">k8s是什么</h1>
<p>在不久的将来，你不懂如何操作 Kubernetes 接口，就等于现在的你不懂最普通的 Linux 命令<br>
Kubernetes是容器集群管理系统，是一个开源的平台，可以实现容器集群的自动化部署、自动扩缩容、维护等功能。</p>
<p>通过Kubernetes你可以：</p>
<ul>
<li>快速部署应用</li>
<li>快速扩展应用</li>
<li>无缝对接新的应用功能</li>
<li>节省资源，优化硬件资源的使用<br>
我们的目标是促进完善组件和工具的生态系统，以减轻应用程序在公有云或私有云中运行的负担。</li>
</ul>
<h3 id="kubernetes-特点">Kubernetes 特点</h3>
<ul>
<li>可移植: 支持公有云，私有云，混合云，多重云（multi-cloud）</li>
<li>可扩展: 模块化, 插件化, 可挂载, 可组合</li>
<li>自动化: 自动部署，自动重启，自动复制，自动伸缩/扩展<br>
Kubernetes是Google 2014年创建管理的，是Google 10多年大规模容器管理技术Borg的开源版本。</li>
</ul>
<h3 id="容器优势总结">容器优势总结</h3>
<ul>
<li>快速创建/部署应用：与VM虚拟机相比，容器镜像的创建更加容易。</li>
<li>持续开发、集成和部署：提供可靠且频繁的容器镜像构建/部署，并使用快速和简单的回滚(由于镜像不可变性)。</li>
<li>开发和运行相分离：在build或者release阶段创建容器镜像，使得应用和基础设施解耦。</li>
<li>开发，测试和生产环境一致性：在本地或外网（生产环境）运行的一致性。</li>
<li>云平台或其他操作系统：可以在 Ubuntu、RHEL、 CoreOS、on-prem、Google Container Engine或其它任何环境中运行。</li>
<li>Loosely coupled，分布式，弹性，微服务化：应用程序分为更小的、独立的部件，可以动态部署和管理。</li>
<li>资源隔离</li>
<li>资源利用：更高效</li>
</ul>
<h1 id="k8s组件">k8s组件</h1>
<figure data-type="image" tabindex="1"><img src="https://freephenix.github.io//post-images/1603086936272.png" alt="" loading="lazy"></figure>
<ul>
<li>Apiserver：所有服务访问统一入口，用于暴露Kubernetes API。任何的资源请求/调用操作都是通过kube-apiserver提供的接口进行。</li>
<li>Crontroller Manager：维持副本期望数目。</li>
<li>Scheduler：负责介绍任务， 选择合适的节点进行分配任务</li>
<li>ETCD：键值对数据库，储存K8S集群所有重要信息(持久化)</li>
<li>Kubelet：直接跟容器引擎交互实现容器的生命周期管理</li>
<li>Kube-proxy：负责写入规则至IPTABLES、IPVS实现服务映射访问</li>
<li>CoreDNS：可以为集群中的SVC创建一个域名IP的对应关系解析</li>
<li>DashBoard：给K8s集群提供B/S结构访问体系</li>
<li>Ingress Controller：官方只能实现四层代理，INGRESS可以实现七层代理</li>
<li>Federation：提供一个可以跨集群中心多K8s统一管理功能</li>
<li>Prometheus：提供K8s集群的监控能力</li>
<li>ELK：提供K8s集群日志统一分析介入平台</li>
</ul>
<h1 id="etcd">ETCD</h1>
<figure data-type="image" tabindex="2"><img src="https://freephenix.github.io//post-images/1603086948968.png" alt="" loading="lazy"></figure>
<h3 id="kube-controller-manager">kube-controller-manager</h3>
<p>kube-controller-manager运行管理控制器，它们是集群中处理常规任务的后台线程。逻辑上，每个控制器是一个单独的进程，但为了降低复杂性，它们都被编译成单个二进制文件，并在单个进程中运行。</p>
<blockquote>
<p>这些控制器包括：<br>
节点（Node）控制器。<br>
副本（Replication）控制器：负责维护系统中每个副本中的pod。<br>
端点（Endpoints）控制器：填充Endpoints对象（即连接Services＆Pods）。<br>
Service Account和Token控制器：为新的Namespace 创建默认帐户访问API Token。</p>
</blockquote>
<h3 id="cloud-controller-manager">cloud-controller-manager</h3>
<p>云控制器管理器负责与底层云提供商的平台交互。云控制器管理器是Kubernetes版本1.6中引入的，目前还是Alpha的功能。<br>
云控制器管理器仅运行云提供商特定的（controller loops）控制器循环。可以通过将--cloud-provider flag设置为external启动kube-controller-manager ，来禁用控制器循环。</p>
<blockquote>
<p>cloud-controller-manager 具体功能：<br>
节点（Node）控制器<br>
路由（Route）控制器<br>
Service控制器<br>
卷（Volume）控制器</p>
</blockquote>
<h3 id="kube-scheduler">kube-scheduler</h3>
<p>kube-scheduler 监视新创建没有分配到Node的Pod，为Pod选择一个Node。</p>
<h1 id="节点node组件">节点（Node）组件</h1>
<p>节点组件运行在Node，提供Kubernetes运行时环境，以及维护Pod。</p>
<h3 id="kubelet">kubelet</h3>
<p>kubelet是主要的节点代理，它会监视已分配给节点的pod，具体功能：</p>
<ul>
<li>安装Pod所需的volume。</li>
<li>下载Pod的Secrets。</li>
<li>Pod中运行的 docker（或experimentally，rkt）容器。</li>
<li>定期执行容器健康检查。</li>
<li>Reports the status of the pod back to the rest of the system, by creating a mirror pod if necessary.</li>
<li>Reports the status of the node back to the rest of the system.</li>
</ul>
<h3 id="kube-proxy">kube-proxy</h3>
<p>kube-proxy通过在主机上维护网络规则并执行连接转发来实现Kubernetes服务抽象。</p>
<h3 id="docker">docker</h3>
<p>docker用于运行容器。</p>
<h3 id="rkt">RKT</h3>
<p>rkt运行容器，作为docker工具的替代方案。</p>
<h3 id="supervisord">supervisord</h3>
<p>supervisord是一个轻量级的监控系统，用于保障kubelet和docker运行。</p>
<h3 id="fluentd">fluentd</h3>
<p>fluentd是一个守护进程，可提供cluster-level logging.。</p>
<h1 id="引用">引用</h1>
<ul>
<li><img src="https://www.kubernetes.org.cn/" alt="k8s中文社区" loading="lazy"></li>
<li><img src="http://docs.kubernetes.org.cn/" alt="k8s中文文档" loading="lazy"></li>
<li><img src="http://dockone.io/article/1448" alt="k8s为什么很重要" loading="lazy"></li>
</ul>

                                </div>
                    </article>
                    <!--  -->
                    
                        <div class="next-post">
                            <div class="next">下一篇</div>
                            <a href="https://freephenix.github.io/gorm-xue-xi-yi-curd/">
                                <h3 class="post-title">
                                    GORM学习(一) 初识
                                </h3>
                            </a>
                        </div>
                        
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li><a href="#k8s%E6%98%AF%E4%BB%80%E4%B9%88">k8s是什么</a><br>
*
<ul>
<li><a href="#kubernetes-%E7%89%B9%E7%82%B9">Kubernetes 特点</a></li>
<li><a href="#%E5%AE%B9%E5%99%A8%E4%BC%98%E5%8A%BF%E6%80%BB%E7%BB%93">容器优势总结</a></li>
</ul>
</li>
<li><a href="#k8s%E7%BB%84%E4%BB%B6">k8s组件</a></li>
<li><a href="#etcd">ETCD</a><br>
*
<ul>
<li><a href="#kube-controller-manager">kube-controller-manager</a></li>
<li><a href="#cloud-controller-manager">cloud-controller-manager</a></li>
<li><a href="#kube-scheduler">kube-scheduler</a></li>
</ul>
</li>
<li><a href="#%E8%8A%82%E7%82%B9node%E7%BB%84%E4%BB%B6">节点（Node）组件</a><br>
*
<ul>
<li><a href="#kubelet">kubelet</a></li>
<li><a href="#kube-proxy">kube-proxy</a></li>
<li><a href="#docker">docker</a></li>
<li><a href="#rkt">RKT</a></li>
<li><a href="#supervisord">supervisord</a></li>
<li><a href="#fluentd">fluentd</a></li>
</ul>
</li>
<li><a href="#%E5%BC%95%E7%94%A8">引用</a></li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://freephenix.github.io//atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
        
            <script>
    window.onload = function() {
        var gitalk = new Gitalk({
            clientID: '008503f8c8bca8787fbe',
            clientSecret: '5f789f71e3288ff1866d17523348881053068eb4',
            repo: 'freephenix.github.io',
            owner: 'freephenix',
            admin: ['freephenix'],
            id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
            distractionFreeMode: false // Facebook-like distraction free mode
        })

        gitalk.render('gitalk-container')
    }
</script>
                

                    
                                
</body>

</html>